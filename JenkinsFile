pipeline {
    agent {
        docker { image 'rafaelsuzano/work:latest' }
    }
  options {
    ansiColor('xterm')
  }

   stages {
       
         stage('Clear') {
           steps {
       
               sh 'npm run report:delete'
              
           }
       }
       
          stage('Dependencies 1') {
           steps {
       
              sh 'export CYPRESS_CACHE_FOLDER=/app/.cache'
              
           }
          }



          stage('Dependencies 2') {
           steps {
       
              sh 'bash -c "chmod -R 775 /home/.cache/cypress/"''
'
              
           }
          }




          stage('Dependencies 22') {
           steps {
       
              sh 'bash -c "CYPRESS_CACHE_FOLDER=/home/.cache/cypress npm ci --legacy-peer-deps'
              
           }
          }


          stage('Dependencies') {
           steps {
       
              sh 'npx cypress install --force'
              
           }
       
       }
         stage('Tests API Ventes' ) {
           steps {
                sh './Executa_Ventes_Teste.sh'
   
 
    }
       
 }  
       


 }



}


