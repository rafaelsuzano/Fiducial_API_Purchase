pipeline {
  agent any

  options {
    ansiColor('xterm')
  }

   stages {
       
        stage('Clear') {
           steps {
       
               sh 'npm run report:delete'
              
           }
       }
       
       stage('Dependencies') {
           steps {
       
              sh 'npx cypress install --force'
              
           }
       }
        stage('Tests API Ventes Clients' ) {
           steps {
               sh '''
               npx cypress run --spec cypress/e2e/Ventes/Clients.cy.js --config video=false,screenshotOnRunFailure=false --reporter junit --reporter-options "mochaFile=reports/TEST-[hash].xml"'
               junitparser merge --glob "reports/TEST-*" "reports/junit-report.xml" 
                               
                '''
  
    }
      post {
    always {
            sh './integration_Ventes_Clients.sh'
            
    }
  }      
 }  
}
}
